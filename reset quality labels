data<-read.csv(file="winequality-white.csv", header=T, sep=";")
dim(data)
names(data)
summary(data)
table(data[,12])



#1.Check for missing values
#colSums(is.na(data))
##The results show no missing values
org_par<-par(no.readonly=TRUE)



#2.reset quality labels (0 and 1)
n<- length(data[,1])
n

#2.1 Select the partition threshold
table(data$quality)
summary(data$quality)
#mean of data:5.878
#median of data:6
#2.1.1 Number of positive and negative samples when the threshold is set to 5
label_5 <- ifelse(data$quality >= 5, 1, 0)
cat("Threshold = 5:\n")
print(table(label_5))

#2.1.2 Number of positive and negative samples when the threshold is set to 6
label_6 <- ifelse(data$quality >= 6, 1, 0)
cat("Threshold = 6:\n")
table(label_6)

#2.1.3 Number of positive and negative samples when the threshold is set to 7
label_7 <- ifelse(data$quality >= 7, 1, 0)
cat("Threshold = 7:\n")
table(label_7)
##First, considering that high-quality red wine is relatively scarce in reality (i.e., the quantity is small), and considering data balance,
##the threshold is selected as 6. Quality ≥ 6 is 1, and quality ≤ 5 is 0.

#2.2 Assign values of 0 and 1 to the quality variable
quality.code<- 0
for(i in 1:n){
if(data[i,12] >=6){quality.code[i]<-1}
else{quality.code[i]<-0}
}

wine<-cbind(data, quality.code)
wine$quality <- NULL
dim(wine)

head(wine)

table(wine$quality.code)

